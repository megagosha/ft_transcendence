{"ast":null,"code":"import { MAT_DIALOG_DATA } from \"@angular/material/dialog\";\nimport { ChatType } from \"../../../services/chat.service\";\nimport { FormControl } from \"@angular/forms\";\nimport { HttpErrorResponse } from \"@angular/common/http\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"../../../services/chat.service\";\nimport * as i3 from \"@angular/material/radio\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@angular/material/input\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/material/icon\";\nimport * as i10 from \"@angular/material/checkbox\";\n\nfunction ChatAccessEditComponent_ul_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 12);\n    i0.ɵɵelementStart(1, \"li\");\n    i0.ɵɵtext(2, \"Everyone can find\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"li\");\n    i0.ɵɵtext(4, \"Everyone can join\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"li\");\n    i0.ɵɵtext(6, \"Everyone can be added by OWNER or ADMIN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ChatAccessEditComponent_ul_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 12);\n    i0.ɵɵelementStart(1, \"li\");\n    i0.ɵɵtext(2, \"Everyone can find\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"li\");\n    i0.ɵɵtext(4, \"Everyone who knows password can join\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"li\");\n    i0.ɵɵtext(6, \"Everyone can be added by ADMIN or OWNER\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ChatAccessEditComponent_ul_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 12);\n    i0.ɵɵelementStart(1, \"li\");\n    i0.ɵɵtext(2, \"Nobody can find\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"li\");\n    i0.ɵɵtext(4, \"Nobody can join\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"li\");\n    i0.ɵɵtext(6, \"Everyone can be added by ADMIN or OWNER\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ChatAccessEditComponent_div_14_mat_error_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.getPasswordError());\n  }\n}\n\nfunction ChatAccessEditComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵelementStart(1, \"mat-form-field\", 14);\n    i0.ɵɵelementStart(2, \"mat-label\");\n    i0.ɵɵtext(3, \"Enter password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"input\", 15);\n    i0.ɵɵelementStart(5, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ChatAccessEditComponent_div_14_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.hide = !ctx_r5.hide;\n    });\n    i0.ɵɵelementStart(6, \"mat-icon\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(8, ChatAccessEditComponent_div_14_mat_error_8_Template, 2, 1, \"mat-error\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"mat-checkbox\", 18);\n    i0.ɵɵlistener(\"ngModelChange\", function ChatAccessEditComponent_div_14_Template_mat_checkbox_ngModelChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.dropVerification = $event;\n    });\n    i0.ɵɵtext(10, \" Drop access for PARTICIPANTs \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"type\", ctx_r3.hide ? \"password\" : \"text\")(\"formControl\", ctx_r3.password)(\"required\", ctx_r3.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx_r3.hide);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.hide ? \"visibility_off\" : \"visibility\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.password.hasError(\"validation\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.dropVerification);\n  }\n}\n\nexport let ChatAccessEditComponent = /*#__PURE__*/(() => {\n  class ChatAccessEditComponent {\n    constructor(data, dialogRef, chatService) {\n      this.dialogRef = dialogRef;\n      this.chatService = chatService;\n      this.dropVerification = false;\n      this.hide = true;\n      this.details = data.details;\n      this.brief = data.brief;\n      this.type = this.details.type;\n      this.saveType = this.type;\n      this.required = this.type != ChatType.PROTECTED;\n      this.password = new FormControl('');\n    }\n\n    ngOnInit() {}\n\n    getPasswordError() {\n      return this.password.getError('validation');\n    }\n\n    onSubmit() {\n      if (this.type == this.saveType) {\n        this.closeDialog();\n      }\n\n      if (this.type != ChatType.PROTECTED) {\n        this.password.setValue(null);\n      }\n\n      this.chatService.updateAccess(this.details.id, {\n        type: this.type,\n        password: this.password.value == null || this.password.value.length == 0 ? null : this.password.value,\n        dropVerification: this.dropVerification\n      }).subscribe(() => {\n        this.details.type = this.type;\n        this.details.dateTimePasswordChange = new Date();\n        this.brief.type = this.type;\n        this.dialogRef.close();\n      }, error => {\n        if (error.status == 400\n        /* BadRequest */\n        ) {\n          const message = error.error.message.toString();\n\n          if (message.toLowerCase().includes(\"пароль\")) {\n            this.password.setErrors({\n              'validation': message\n            });\n          } else {\n            throw new HttpErrorResponse(error);\n          }\n        } else {\n          throw new HttpErrorResponse(error);\n        }\n      });\n    }\n\n    closeDialog() {\n      this.dialogRef.close();\n    }\n\n  }\n\n  ChatAccessEditComponent.ɵfac = function ChatAccessEditComponent_Factory(t) {\n    return new (t || ChatAccessEditComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.MatDialogRef), i0.ɵɵdirectiveInject(i2.ChatService));\n  };\n\n  ChatAccessEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChatAccessEditComponent,\n    selectors: [[\"app-chat-password-edit\"]],\n    inputs: {\n      details: \"details\",\n      brief: \"brief\"\n    },\n    decls: 20,\n    vars: 6,\n    consts: [[2, \"text-align\", \"center\", \"margin\", \"0 0 15px\", \"font-size\", \"12pt\", \"font-weight\", \"500\"], [2, \"width\", \"100%\", \"height\", \"calc(100% - 20px - 70px)\", \"overflow-y\", \"auto\", \"scrollbar-width\", \"thin\"], [\"color\", \"primary\", \"aria-label\", \"Select chat access type\", 2, \"display\", \"flex\", \"justify-content\", \"space-between\", \"width\", \"100%\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"PUBLIC\"], [\"value\", \"PROTECTED\"], [\"value\", \"PRIVATE\"], [2, \"width\", \"calc(100% - 5px)\", \"margin-left\", \"5px\", \"color\", \"#5b5b5b\", \"margin-bottom\", \"15px\", 3, \"ngSwitch\"], [\"class\", \"access-type-description\", 4, \"ngSwitchCase\"], [\"style\", \"width: 100%\", 4, \"ngIf\"], [\"mat-dialog-actions\", \"\", 2, \"width\", \"100%\", \"display\", \"flex\", \"justify-content\", \"space-around\"], [\"mat-button\", \"\", 3, \"click\"], [\"mat-button\", \"\", \"type\", \"submit\", \"value\", \"submit\", \"cdkFocusInitial\", \"\", 3, \"click\"], [1, \"access-type-description\"], [2, \"width\", \"100%\"], [\"appearance\", \"fill\", 2, \"width\", \"100%\"], [\"autocomplete\", \"off\", \"matInput\", \"\", 3, \"type\", \"formControl\", \"required\"], [\"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [4, \"ngIf\"], [\"color\", \"primary\", 2, \"margin-top\", \"-5px\", 3, \"ngModel\", \"ngModelChange\"]],\n    template: function ChatAccessEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p\", 0);\n        i0.ɵɵtext(1, \" Access type edit\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 1);\n        i0.ɵɵelementStart(3, \"mat-radio-group\", 2);\n        i0.ɵɵlistener(\"ngModelChange\", function ChatAccessEditComponent_Template_mat_radio_group_ngModelChange_3_listener($event) {\n          return ctx.type = $event;\n        });\n        i0.ɵɵelementStart(4, \"mat-radio-button\", 3);\n        i0.ɵɵtext(5, \"PUBLIC\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"mat-radio-button\", 4);\n        i0.ɵɵtext(7, \"PROTECTED\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"mat-radio-button\", 5);\n        i0.ɵɵtext(9, \"PRIVATE\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 6);\n        i0.ɵɵtemplate(11, ChatAccessEditComponent_ul_11_Template, 7, 0, \"ul\", 7);\n        i0.ɵɵtemplate(12, ChatAccessEditComponent_ul_12_Template, 7, 0, \"ul\", 7);\n        i0.ɵɵtemplate(13, ChatAccessEditComponent_ul_13_Template, 7, 0, \"ul\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, ChatAccessEditComponent_div_14_Template, 11, 8, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 9);\n        i0.ɵɵelementStart(16, \"button\", 10);\n        i0.ɵɵlistener(\"click\", function ChatAccessEditComponent_Template_button_click_16_listener() {\n          return ctx.closeDialog();\n        });\n        i0.ɵɵtext(17, \"Back\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"button\", 11);\n        i0.ɵɵlistener(\"click\", function ChatAccessEditComponent_Template_button_click_18_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵtext(19, \"Apply\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.type);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngSwitch\", ctx.type);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"PUBLIC\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"PROTECTED\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngSwitchCase\", \"PRIVATE\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.type == \"PROTECTED\");\n      }\n    },\n    directives: [i3.MatRadioGroup, i4.NgControlStatus, i4.NgModel, i3.MatRadioButton, i5.NgSwitch, i5.NgSwitchCase, i5.NgIf, i6.MatFormField, i6.MatLabel, i7.MatInput, i4.DefaultValueAccessor, i4.FormControlDirective, i4.RequiredValidator, i8.MatButton, i6.MatSuffix, i9.MatIcon, i6.MatError, i10.MatCheckbox, i1.MatDialogActions],\n    styles: [\".access-type-description[_ngcontent-%COMP%]{padding:0;list-style-position:inside}\"]\n  });\n  return ChatAccessEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}