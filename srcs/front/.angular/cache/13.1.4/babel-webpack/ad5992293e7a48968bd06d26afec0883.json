{"ast":null,"code":"import { FormControl, Validators } from \"@angular/forms\";\nimport { debounceTime, map, of, startWith, switchMap } from \"rxjs\";\nimport { catchError } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"../../services/user.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/autocomplete\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/core\";\n\nfunction FindFriendComponent_mat_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 9);\n    i0.ɵɵelement(1, \"img\", 10);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" | \");\n    i0.ɵɵelementStart(5, \"small\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const user_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", user_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", user_r3.avatarImgName, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r3.username);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Status: \", user_r3.status, \"\");\n  }\n}\n\nfunction FindFriendComponent_mat_error_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Something went wrong. Try again. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let FindFriendComponent = /*#__PURE__*/(() => {\n  class FindFriendComponent {\n    constructor(dialogRef, userService, dialog) {\n      this.dialogRef = dialogRef;\n      this.userService = userService;\n      this.dialog = dialog;\n      this.autoCompleteControl = new FormControl(\"\", [Validators.required]);\n      this.err = false;\n      this._userService = userService;\n    }\n\n    lookup(value) {\n      return this._userService.searchUserByUsername(value, 1).pipe(map(results => results), catchError(_ => {\n        return of([]);\n      }));\n    }\n\n    ngOnInit() {\n      this.apiCtrl = this.autoCompleteControl.valueChanges.pipe(startWith(\"\"), debounceTime(300), switchMap(value => {\n        if (value != \"\") {\n          return this.lookup(value);\n        } else {\n          return of([]);\n        }\n      }));\n    }\n\n    displayFn(user) {\n      if (user && user.username) return user.username;else return \"\";\n    }\n\n    selectOption(event) {\n      if (event) {\n        this._userService.addFriend(event.option.value.id).subscribe(res => {\n          if (res && res.body != null) {\n            // this._userService.appendFriend(res.body);\n            this.dialogRef.close({\n              data: res.body\n            });\n          }\n        }, error => {\n          this.autoCompleteControl.setErrors({\n            \"add_friend\": true\n          });\n        });\n      }\n    }\n\n  }\n\n  FindFriendComponent.ɵfac = function FindFriendComponent_Factory(t) {\n    return new (t || FindFriendComponent)(i0.ɵɵdirectiveInject(i1.MatDialogRef), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i1.MatDialog));\n  };\n\n  FindFriendComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FindFriendComponent,\n    selectors: [[\"app-find-friend\"]],\n    decls: 13,\n    vars: 7,\n    consts: [[1, \"add-friend-dialog\"], [\"mat-dialog-title\", \"\"], [\"id\", \"friend-form\", 1, \"find-friend-form\"], [\"appearance\", \"fill\", 1, \"friend-full-width\"], [\"matInput\", \"\", \"aria-label\", \"Username\", 3, \"matAutocomplete\", \"formControl\"], [\"autoActiveFirstOption\", \"\", 3, \"displayWith\", \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [3, \"value\"], [\"aria-hidden\", \"\", \"height\", \"25\", 1, \"autocomplete-avatar-img\", 3, \"src\"]],\n    template: function FindFriendComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"h1\", 1);\n        i0.ɵɵtext(2, \"Find friend\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"form\", 2);\n        i0.ɵɵelementStart(4, \"mat-form-field\", 3);\n        i0.ɵɵelementStart(5, \"mat-label\");\n        i0.ɵɵtext(6, \"Username\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"input\", 4);\n        i0.ɵɵelementStart(8, \"mat-autocomplete\", 5, 6);\n        i0.ɵɵlistener(\"optionSelected\", function FindFriendComponent_Template_mat_autocomplete_optionSelected_8_listener($event) {\n          return ctx.selectOption($event);\n        });\n        i0.ɵɵtemplate(10, FindFriendComponent_mat_option_10_Template, 7, 4, \"mat-option\", 7);\n        i0.ɵɵpipe(11, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, FindFriendComponent_mat_error_12_Template, 2, 0, \"mat-error\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(9);\n\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"matAutocomplete\", _r0)(\"formControl\", ctx.autoCompleteControl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"displayWith\", ctx.displayFn);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(11, 5, ctx.apiCtrl));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.autoCompleteControl.hasError(\"add_friend\"));\n      }\n    },\n    directives: [i1.MatDialogTitle, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i4.MatFormField, i4.MatLabel, i5.MatInput, i6.MatAutocompleteTrigger, i3.DefaultValueAccessor, i3.NgControlStatus, i3.FormControlDirective, i6.MatAutocomplete, i7.NgForOf, i8.MatOption, i7.NgIf, i4.MatError],\n    pipes: [i7.AsyncPipe],\n    styles: [\".add-friend-dialog[_ngcontent-%COMP%]{height:300px}.find-friend-form[_ngcontent-%COMP%]{width:100%}.mat-dialog-title[_ngcontent-%COMP%]{color:#000}.friend-full-width[_ngcontent-%COMP%]{width:100%}.autocomplete-avatar-img[_ngcontent-%COMP%]{vertical-align:middle;margin-right:8px}[dir=rtl][_ngcontent-%COMP%]   .example-option-img[_ngcontent-%COMP%]{margin-right:0;margin-left:8px}.addfriend-button[_ngcontent-%COMP%]{float:right}\"]\n  });\n  return FindFriendComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}